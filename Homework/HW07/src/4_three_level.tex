
The system employs a 48-bit virtual address space with byte-addressable memory, using 4KB pages and 32-bit page table entries (PTEs) where 8 bits are reserved for protection and valid flags. The address translation uses a three-level page table hierarchy. Each of the three page table index fields is 10 bits. 

\begin{parts}
    \part [4] Given the virtual address $\mathtt{0x3456789ABC}$. Suppose the contents of the page table entries of the three-level page table are as follows:
    \begin{itemize}[leftmargin=*]
    \item The base address of the first-level page table is $\mathtt{0x1000}$.
    \item The base address of the second-level page table is $\mathtt{0x2000}$.
    \item The base address of the third-level page table is $\mathtt{0x3000}$, and the PTE with index 3 points to the Physical Page Frame (PPN) $\mathtt{0x4000}$. [4 points]
    \end{itemize}
    \vspace{0.5cm}
    Final physical address:\blank[3cm]{0x4000ABC}.
    \vspace{0.5cm}
    
    \part[4] Calculate the total size of all second-level page tables. [4 points]
    \begin{solution}
        One level of the page table has $2^{10}$ entries, each entry is 4 bytes, so the size of one second-level page table is:
        \[
        \text{Size of one second-level page table} = 2^{10} \times 4 \text{ bytes} = 4096 \text{ bytes} = 4 \text{ KB}
        \]
        Since there are $2^{10}$ second-level page tables (one for each first-level entry), the total size is:
        \[
        \text{Total size of all second-level page tables} = 2^{10} \times 4 \text{ KB} = 4 \text{ MB}
        \]
    \end{solution}
    
    \newpage

    \part[4] Consider an x86-64 system with 64-bit virtual addressing (48-bit usable), 4KB page tables, and 8-byte PTEs, supporting both 4KB pages (4-level: PML4$\to$PDPT$\to$PD$\to$PT) and 2MB huge pages (3-level, no PT). When using 2MB huge pages for application data, how is the virtual address partitioned?  \textbf{Specify bit allocations for PML4, PDPT, PD indices and page offset as [high:low] ranges using zero-based indexing}. [4 points]

    \begin{solution}
        \begin{itemize}
            \item PML4 index: [47:39]
            \item PDPT index: [38:30]
            \item PD index: [29:21]
            \item Page offset: [20:0]
        \end{itemize}
    \end{solution}


\end{parts}
